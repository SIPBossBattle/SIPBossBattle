<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Boss Battle</title>
  <style>
    :root{
      --bar-height: 22px;
      --bar-bg: rgba(0,0,0,.35);
      --bar-fill: #e74c3c;
      --panel-bg: rgba(0,0,0,.45);
      --text: #fff;
      --shadow: 0 2px 10px rgba(0,0,0,.35);
      --btn-bg: #222;
      --btn-bg-hover: #333;
      --btn-text: #fff;
      --accent: #ffd166;
      --anim-speed: 30s; /* background scroll speed */
    }

    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      background: #000;
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }

    /* Stage container with scrolling background */
    .stage {
      position: relative;
      width: 100%;
      height: 100dvh;
      overflow: hidden;

      background-repeat: repeat-x;
      background-position: 0 50%;
      background-size: cover;
      animation: scrollX var(--anim-speed) linear infinite;
    }
    @keyframes scrollX {
      from { background-position: 0 50%; }
      to   { background-position: -1600px 50%; }
    }

    /* Top HUD: name + health bar + Next Boss */
    .hud {
      position: absolute;
      top: 12px;
      left: 12px;
      right: 12px;
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 12px;
      align-items: center;
      z-index: 5;
    }
    .name-and-hp {
      display: grid;
      gap: 6px;
    }
    .boss-name {
      font-weight: 700;
      letter-spacing: .3px;
      text-shadow: var(--shadow);
    }
    .hpbar {
      position: relative;
      height: var(--bar-height);
      border-radius: 999px;
      background: var(--bar-bg);
      overflow: hidden;
      box-shadow: var(--shadow);
    }
    .hpbar__fill {
      position: absolute;
      inset: 0;
      width: 100%;
      background: linear-gradient(90deg, #ff6b6b, var(--bar-fill));
      transform-origin: left center;
      transition: transform 140ms ease-out;
    }
    .hpbar__label {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
      text-shadow: 0 1px 2px rgba(0,0,0,.7);
      pointer-events: none;
    }

    .next-btn {
      justify-self: end;
      background: var(--panel-bg);
      border: 1px solid rgba(255,255,255,.18);
      color: var(--accent);
      padding: 10px 14px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: .5px;
      box-shadow: var(--shadow);
    }
    .next-btn:hover { filter: brightness(1.1); }

    /* Boss sprite centered */
    .boss {
      position: absolute;
      left: 50%;
      top: 55%;
      transform: translate(-50%, -50%);
      max-width: min(60vmin, 520px);
      width: 60vw;
      pointer-events: none;
      image-rendering: auto;
      filter: drop-shadow(0 10px 30px rgba(0,0,0,.55));
    }

    /* Bottom action panel */
    .actions {
      position: absolute;
      left: 0; right: 0; bottom: 0;
      padding: 16px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      background: linear-gradient(180deg, transparent, rgba(0,0,0,.45));
      z-index: 5;
    }
    .btn {
      background: var(--btn-bg);
      color: var(--btn-text);
      border: 1px solid rgba(255,255,255,.15);
      padding: 12px 18px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 700;
      letter-spacing: .3px;
      box-shadow: var(--shadow);
      min-width: 140px;
      transition: transform .06s ease, background .15s ease;
    }
    .btn:hover { background: var(--btn-bg-hover); }
    .btn:active { transform: translateY(1px) scale(.98); }

    /* Small helper hint (optional) */
    .hint {
      position: absolute;
      left: 50%;
      bottom: 78px;
      transform: translateX(-50%);
      font-size: 12px;
      opacity: .7;
      text-align: center;
      padding: 4px 8px;
      background: rgba(0,0,0,.25);
      border-radius: 6px;
    }

    @media (max-width: 600px) {
      .boss { top: 52%; }
      .btn { min-width: 120px; padding: 12px 14px; }
    }
  </style>
</head>
<body>

  <main id="stage" class="stage" role="img" aria-label="Boss battle background">
    <!-- HUD -->
    <div class="hud">
      <div class="name-and-hp">
        <div id="bossName" class="boss-name">—</div>
        <div class="hpbar" aria-label="Boss health">
          <div id="hpFill" class="hpbar__fill"></div>
          <div id="hpLabel" class="hpbar__label">— / —</div>
        </div>
      </div>
      <button id="nextBossBtn" class="next-btn" type="button">Next Boss ➜</button>
    </div>

    <!-- Boss sprite -->
    <img id="bossSprite" class="boss" alt="Boss" src="" />

    <!-- Action buttons -->
    <div id="actions" class="actions" aria-label="Action buttons">
      <!-- buttons injected by JS -->
    </div>

    <div class="hint">Tip: Use the buttons to deal damage. “Next Boss” resets the next boss to full health.</div>
  </main>

  <script>
    // --- Boss data ---
    const BOSSES = [
      {
        name: "Tralalero Tralala",
        bg: "assets/Tralalero_Tralala_Background.png",
        sprite: "assets/Tralalero_Tralala.png",
        maxHP: 3,
        attacks: [
          { label: "Bop (-1)", damage: 1 }
        ]
      },
      {
        name: "Ballerina Cappuccina",
        bg: "assets/Ballerina_Cappuccina_Background.png",
        sprite: "assets/Ballerina_Cappuccina.png",
        maxHP: 20,
        attacks: [
          { label: "Twirl Hit (-1)", damage: 1 }
        ]
      },
      {
        name: "Tung Sahur",
        bg: "assets/Tung_Sahur_Background.png",
        sprite: "assets/Tung_Sahur.png",
        maxHP: 100,
        attacks: [
          { label: "Tap (-1)", damage: 1 },
          { label: "Blast (-5)", damage: 5 }
        ]
      }
    ];

    // --- State ---
    let idx = 0;
    let hp = BOSSES[0].maxHP;

    // --- Elements ---
    const stage = document.getElementById('stage');
    const bossName = document.getElementById('bossName');
    const bossSprite = document.getElementById('bossSprite');
    const hpFill = document.getElementById('hpFill');
    const hpLabel = document.getElementById('hpLabel');
    const actions = document.getElementById('actions');
    const nextBossBtn = document.getElementById('nextBossBtn');

    function clamp(n, min, max) { return Math.max(min, Math.min(max, n)); }

    function renderBoss() {
      const b = BOSSES[idx];
      hp = b.maxHP; // reset to full health on load or when cycling
      stage.style.backgroundImage = `url('${b.bg}')`;
      bossSprite.src = b.sprite;
      bossSprite.alt = b.name;
      bossName.textContent = b.name;
      document.title = `${b.name} — Boss Battle`;

      // (Re)build action buttons
      actions.innerHTML = '';
      b.attacks.forEach(att => {
        const btn = document.createElement('button');
        btn.className = 'btn';
        btn.type = 'button';
        btn.textContent = att.label;
        btn.addEventListener('click', () => applyDamage(att.damage));
        actions.appendChild(btn);
      });

      updateHP();
    }

    function updateHP() {
      const b = BOSSES[idx];
      const ratio = clamp(hp / b.maxHP, 0, 1);
      hpFill.style.transform = `scaleX(${ratio})`;
      hpLabel.textContent = `${hp} / ${b.maxHP}`;
      // subtle flash when taking damage
      if (ratio > 0 && ratio < 1) {
        hpFill.animate(
          [{ filter: 'brightness(1)' }, { filter: 'brightness(1.6)' }, { filter: 'brightness(1)' }],
          { duration: 180, iterations: 1 }
        );
      }
      // optional: auto-advance when HP hits 0? (Not requested, so we keep manual Next Boss)
    }

    function applyDamage(amount) {
      if (hp <= 0) return;
      hp = clamp(hp - amount, 0, BOSSES[idx].maxHP);
      updateHP();
    }

    nextBossBtn.addEventListener('click', () => {
      idx = (idx + 1) % BOSSES.length;
      renderBoss(); // full heal is applied in renderBoss()
    });

    // Start with the first boss at full health
    renderBoss();
  </script>
</body>
</html>
